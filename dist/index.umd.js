(function(i,d){typeof exports=="object"&&typeof module<"u"?d(exports,require("axios"),require("redux-actions"),require("memoize-state")):typeof define=="function"&&define.amd?define(["exports","axios","redux-actions","memoize-state"],d):(i=typeof globalThis<"u"?globalThis:i||self,d(i.ReactReduxApiHelpers={},i.axios,i.ReduxActions,i.memoizeState))})(this,function(i,d,E,W){"use strict";var Fe=Object.defineProperty;var Ne=(i,d,E)=>d in i?Fe(i,d,{enumerable:!0,configurable:!0,writable:!0,value:E}):i[d]=E;var _=(i,d,E)=>(Ne(i,typeof d!="symbol"?d+"":d,E),E);let C;const X=(t="http://localhost:3000")=>{C=d.create({baseURL:t,headers:{"Content-Type":"application/json"},method:"get"})},q=t=>{if(typeof C>"u")throw new Error("need init axios instance");{const{data:e,token:n}=t;return C({...e}).then(r=>r).catch(r=>{const{statusText:o,status:a}=r.response||{};throw{statusText:o,status:a,response:r.response}})}},J=Object.freeze(Object.defineProperty({__proto__:null,axios:q,init:X},Symbol.toStringTag,{value:"Module"})),Y=function(t,e){e=Object.assign({},{responseDataPrepare:void 0,preventSuccess:!1,preventFailure:!1,postSaveToStoreCallback:!1},e);const r=E.createAction(t);return(o,a)=>{const s=r(o);return typeof s<"u"&&typeof a<"u"&&(s.onFailure=a.onFailure,s.onSuccess=a.onSuccess,s.key=a.key,s.preventSuccess=a.preventSuccess,s.preventFailure=a.preventFailure,s.postSaveToStoreCallback=a.postSaveToStoreCallback),s.responseDataPrepare=e.responseDataPrepare,s}};function U(t){const e=t.replace("_REQUEST","_SUCCESS"),n=t.replace("_REQUEST","_FAILED");return{successAction:e,failedAction:n}}const Z=W(function(t,e){const r={onlyResultObject:!0,filter:"success",resultPrepareCallback:void 0,key:void 0,initialData:(()=>{const a=[];return a.loaded=!1,a})()},o=Object.assign({},r,e);if(/^.*_REQUEST$/.test(t)){const a=t.split("_REQUEST")[0];return function(s){let u={status:!1};const c=`${a}_FAILED${o.key?o.key:""}`,l=`${a}_SUCCESS${o.key?o.key:""}`;let p=0;c in s.api&&(p=s.api[c].timestamp||0,u=Object.assign(u,s.api[c]),u.status="failed"),l in s.api&&p<(s.api[l].timestamp||0)&&(u=Object.assign(u,s.api[l]),u.status="success");let y=u;switch(o.onlyResultObject&&(typeof u.responseData<"u"?y=u.responseData:y=o.initialData),!0){case o.filter===u.status:{typeof y=="object"&&y!==null&&(y.loaded=!0);break}case o.filter===!1:{typeof y=="object"&&y!==null&&(y.loaded=!0);break}default:y=o.initialData}return typeof o.resultPrepareCallback=="function"?o.resultPrepareCallback(y):y}}else throw new Error("Action Name incorrect! Check: "+t)}),ee=Object.freeze(Object.defineProperty({__proto__:null,actionCreator:Y,apiSelector:Z,getConstantsFromRequestConstant:(t,e="/")=>{const n=t.split("_REQUEST")[0],r=n+"_FAILED",o=n+"_SUCCESS",a={};return a[o.split(e)[1]]=o,a[r.split(e)[1]]=r,a[t.split(e)[1]]=t,a},responseActionsTypes:U},Symbol.toStringTag,{value:"Module"}));class te{constructor(){_(this,"routes",{});_(this,"add",(e,n)=>{if(typeof n=="function")e in this.routes&&console.warn("Check your key! This key is already in use."),this.routes[e]=n;else throw new Error("Check your arguments")})}}const T=(()=>{let t;return function(){return t||(t=new te),t}})(),ne=T();var R=function(e){return"@@redux-saga/"+e},re=R("CANCEL_PROMISE"),$=R("IO"),oe=R("MULTICAST"),ae=function(e){return e==null},v=function(e){return e!=null},S=function(e){return typeof e=="function"},x=function(e){return typeof e=="string"},A=Array.isArray,se=function(e){return e&&!A(e)&&typeof e=="object"},D=function t(e){return e&&(x(e)||ie(e)||S(e)||A(e)&&e.every(t))},h=function(e){return e&&S(e.take)&&S(e.close)},ue=function(e){return S(e)&&e.hasOwnProperty("toString")},ie=function(e){return!!e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype},fe=function(e){return h(e)&&e[oe]},ce=function(e){return e&&e[$]},O=2147483647;function le(t,e){if(e===void 0&&(e=!0),process.env.NODE_ENV!=="production"&&t>O)throw new Error("delay only supports a maximum value of "+O+"ms");var n,r=new Promise(function(o){n=setTimeout(o,Math.min(O,t),e)});return r[re]=function(){clearTimeout(n)},r}process.env.NODE_ENV!=="production"&&typeof Proxy<"u";function f(t,e,n){if(!e(t))throw new Error(n)}var de=function(e){throw e},pe=function(e){return{value:e,done:!0}};function ye(t,e,n){e===void 0&&(e=de),n===void 0&&(n="iterator");var r={meta:{name:n},next:t,throw:e,return:pe,isSagaIterator:!0};return typeof Symbol<"u"&&(r[Symbol.iterator]=function(){return r}),r}var F="TAKE",ve="PUT",me="CALL",Se="FORK",g=function(e,n){var r;return r={},r[$]=!0,r.combinator=!1,r.type=e,r.payload=n,r};function Ee(t,e){if(t===void 0&&(t="*"),process.env.NODE_ENV!=="production"&&arguments.length&&f(arguments[0],v,"take(patternOrChannel): patternOrChannel is undefined"),D(t))return v(e)&&console.warn("take(pattern) takes one argument but two were provided. Consider passing an array for listening to several action types"),g(F,{pattern:t});if(fe(t)&&v(e)&&D(e))return g(F,{channel:t,pattern:e});if(h(t))return v(e)&&console.warn("take(channel) takes one argument but two were provided. Second argument is ignored."),g(F,{channel:t});if(process.env.NODE_ENV!=="production")throw new Error("take(patternOrChannel): argument "+t+" is not valid channel or a valid pattern")}function ge(t,e){return process.env.NODE_ENV!=="production"&&(arguments.length>1?(f(t,v,"put(channel, action): argument channel is undefined"),f(t,h,"put(channel, action): argument "+t+" is not a valid channel"),f(e,v,"put(channel, action): argument action is undefined")):f(t,v,"put(action): argument action is undefined")),ae(e)&&(e=t,t=void 0),g(ve,{channel:t,action:e})}var I=function(e,n){if(f(n,v,e+": argument fn is undefined or null"),!S(n)){var r=null,o;if(A(n))r=n[0],o=n[1],f(o,v,e+": argument of type [context, fn] has undefined or null `fn`");else if(se(n))r=n.context,o=n.fn,f(o,v,e+": argument of type {context, fn} has undefined or null `fn`");else{f(n,S,e+": argument fn is not function");return}if(r&&x(o)){f(r[o],S,e+': context arguments has no such method - "'+o+'"');return}f(o,S,e+": unpacked fn argument (from [context, fn] or {context, fn}) is not a function")}};function L(t,e){var n=null,r;return S(t)?r=t:(A(t)?(n=t[0],r=t[1]):(n=t.context,r=t.fn),n&&x(r)&&S(n[r])&&(r=n[r])),{context:n,fn:r,args:e}}var be=function(e){return e!==ke};function P(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];if(process.env.NODE_ENV!=="production"){var o=typeof n[0]=="number"?n[0]:"ms";f(t,be,"instead of writing `yield call(delay, "+o+")` where delay is an effect from `redux-saga/effects` you should write `yield delay("+o+")`"),I("call",t)}return g(me,L(t,n))}function M(t){process.env.NODE_ENV!=="production"&&(I("fork",t),f(t,function(o){return!ce(o)},"fork: argument must not be an effect"));for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return g(Se,L(t,n))}var ke=P.bind(null,le),V=function(e){return{done:!0,value:e}},N={};function Ae(t){return h(t)?"channel":ue(t)?String(t):S(t)?t.name:String(t)}function he(t,e,n){var r,o,a,s=e;function u(c,l){if(s===N)return V(c);if(l&&!o)throw s=N,l;r&&r(c);var p=l?t[o](l):t[s]();return s=p.nextState,a=p.effect,r=p.stateUpdater,o=p.errorState,s===N?V(c):a}return ye(u,function(c){return u(null,c)},n)}function we(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];var a={done:!1,value:Ee(t)},s=function(p){return{done:!1,value:M.apply(void 0,[e].concat(r,[p]))}},u,c=function(p){return u=p};return he({q1:function(){return{nextState:"q2",effect:a,stateUpdater:c}},q2:function(){return{nextState:"q1",effect:s(u)}}},"q1","takeEvery("+Ae(t)+", "+e.name+")")}var Ce=function(e,n,r){f(n,v,e.name+" requires a pattern or channel"),f(r,v,e.name+" requires a saga parameter")};function Q(t,e){process.env.NODE_ENV!=="production"&&Ce(Q,t,e);for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];return M.apply(void 0,[we,t,e].concat(r))}const z=T();function*Te(t,e,n){const o={...{apiService:q,additiveCallback:null,successCallback:null,failedCallback:null,stopRequest:()=>!1,preventSuccessAction:!1,preventFailedAction:!1,call:P,put:ge},...n},{additiveCallback:a,apiService:s,successCallback:u,failedCallback:c,stopRequest:l,preventSuccessAction:p,preventFailedAction:y,call:b,put:K}=o,B=e[t.type];if(typeof B=="function"){let k=B(t.payload);typeof a=="function"&&(k=yield b(a,k));const G=U(t.type);try{if(!l(k)){typeof t.beforeRequestCallback=="function"&&t.beforeRequestCallback(k);let m=yield b(s,{data:k});typeof t.onSuccess=="function"&&t.onSuccess(m),typeof u=="function"&&(yield b(u,m)),typeof t.responseDataPrepare=="function"&&(m=t.responseDataPrepare(m)),p||t.preventSuccess||(yield K({response:m,type:G.successAction,payload:t.payload,key:t.key})),typeof t.postSaveToStoreCallback=="function"&&(yield b(t.postSaveToStoreCallback,m))}}catch(m){console.error(m);const H={type:G.failedAction,payload:t.payload,message:m.statusText,status:m.status,response:m.response,key:t.key};typeof t.onFailure=="function"&&t.onFailure(m),typeof c=="function"&&(yield b(c,H)),y||t.preventFailure||(yield K(H))}}else throw new Error(`Api method: [${t.type}]() isn't defined. Please, create it! Or use another name of action!`)}function*Re(t={},e=Q){yield e("*",function*(n){/^.*_REQUEST$/.test(n.type)&&z.routes[n.type]&&(yield Te(n,z.routes,t))})}const j={},w=function(t=j,e,n){const r={...t};return r[e]=n,r};function xe(t=j,e){var a,s;const n=/^.*_REQUEST$/.test(e.type),r=/^.*_CLEAR$/.test(e.type),o=e.type==="FORCE_CLEAR_ALL_API";if(typeof e.response<"u"&&typeof e.response.data<"u"||n||r||o)switch(!0){case n:return w(t,`${e.type}${e.key?e.key:""}`,Object.assign({},e,{loading:!0}));case/^.*_SUCCESS$/.test(e.type):return w(t,`${e.type}${e.key?e.key:""}`,Object.assign({},{responseData:(a=e.response)==null?void 0:a.data},{loading:!1,loaded:!0,timestamp:Date.now()}));case/^.*_FAILED$/.test(e.type):return w(t,`${e.type}${e.key?e.key:""}`,Object.assign({},{responseData:(s=e.response)==null?void 0:s.data},{loading:!1,loaded:!1,timestamp:Date.now()}));case r:return w(t,`${e.type.replace("CLEAR","SUCCESS")}${e.key?e.key:""}`,{});case o:return j;default:return t}else return t}const Oe=Object.freeze(Object.defineProperty({__proto__:null,ApiRoutes:T,apiDefaultReducer:xe,apiRoutes:ne,apiWatchRequest:Re},Symbol.toStringTag,{value:"Module"}));i.axios=J,i.helpers=ee,i.modules=Oe,Object.defineProperty(i,Symbol.toStringTag,{value:"Module"})});
