<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: helpers/apiSelector.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: helpers/apiSelector.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * [apiSelector description]
 * @param  {string} actionName - rgument for get data of from state
 * @param  {object} options    - settings
 * 	  @param [any] filter - use for get only sucess responce - 'success', if false - 'all'
 * 		@param [boolean] onlyResultObject - use for get only result data
 * 		@param [any] initialData - set default responce( if date not founded)
 * 	 	@param [function]  resultPrepareCalback  - prepare data before return
 * @return {result}
 */

export function apiSelector(actionName, options) {
	let defaultOptions = {
		onlyResultObject: true,
		filter: false,
		resultPrepareCalback: function(res) {
			return res
		},
		initialData: [],
	}
	options = Object.assign({}, defaultOptions, options)

	if (/^.*_REQUEST$/.test(actionName)) {
		var partActionName = actionName.split('_REQUEST')[0]

		return function(state) {
			var result = {
				status: false,
			}
			var failedName = partActionName + '_FAILED'
			var successName = partActionName + '_SUCCESS'
			var timeStamp = 0

			if (failedName in state.api) {
				timeStamp = state.api[failedName].timestamp
				result = Object.assign(result, state.api[failedName])
				result.status = 'failed'
			}
			if (successName in state.api &amp;&amp; timeStamp &lt; state.api[successName].timestamp) {
				result = Object.assign(result, state.api[successName])
				result.status = 'success'
			}
			let tempRes = result

			if (options.onlyResultObject) {
				if (typeof result.responseData !== 'undefined') {
					tempRes = result.responseData
				} else {
					tempRes = options.initialData
				}
			}
			switch (true) {
				case options.filter === result.status:
					result = tempRes
					break
				case options.filter === false:
					result = tempRes
					break
				default:
					result = options.initialData
			}
			if (typeof options.resultPrepareCalback === 'function') {
				return options.resultPrepareCalback(result)
			} else {
				return result
			}
		}
	} else {
		throw new Error('Action Name incorrect! Check:' + actionName)
	}
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#apiReducers">apiReducers</a></li><li><a href="global.html#apiSelector">apiSelector</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Wed Mar 20 2019 15:58:20 GMT+0300 (Moscow Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
